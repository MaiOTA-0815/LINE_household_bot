# 📊 LINE Household Bot（LINE家計簿Bot）

**日本語 | [English](#-english-version)**  

---

## 📝 概要
LINEで入力した支出を、AWS Lambda経由でNotionに自動登録するBotです。  
日々の家計管理をLINE上で簡単に記録できます。

---

## 🛠 使用技術
- Python 3.10  
- Flask  
- LINE Messaging API（line-bot-sdk）  
- Notion API（notion-client）  
- AWS Lambda + API Gateway（Zappa）  
- Git / GitHub  

---

## 🚀 セットアップ方法（ローカル）
1. **仮想環境の作成と有効化**
    ```bash
    python -m venv venv
    source venv/Scripts/activate  # Windows（Git Bash）
    ```

2. **ライブラリのインストール**
    ```bash
    pip install -r requirements.txt
    ```

3. **`.env`ファイルの作成**  
   以下を記載し、`.gitignore`でGit管理対象外にします。
    ```
    LINE_CHANNEL_ACCESS_TOKEN=あなたのトークン
    LINE_CHANNEL_SECRET=あなたのシークレット
    NOTION_TOKEN=あなたのNotionトークン
    DATABASE_ID=あなたのNotionデータベースID
    ```

4. **ローカルサーバ起動**
    ```bash
    python line-bot-server.py
    ```

5. **テスト用に公開（Ngrok）**
    ```bash
    ngrok http 5000
    ```
    出力されたURLをLINE DevelopersのWebhook URLに設定。

---

## ☁ デプロイ（AWS Lambda）
1. 初回デプロイ  
    ```bash
    zappa deploy dev
    ```
2. 更新時  
    ```bash
    zappa update dev
    ```
3. LINE DevelopersのWebhook URLを、Zappa発行のAPI Gateway URLに変更。

---

## 📩 メッセージ送信フォーマット
2025/08/01 食費 1200 スーパーで買い物

**Notion登録項目**  
- 日付：2025/08/01  
- カテゴリ：食費  
- 金額：1200  
- メモ：スーパーで買い物  

---

## 🔒 セキュリティ対策
- `.env`や`zappa_settings.json`は`.gitignore`済み  
- 機密情報はAWS Lambdaの環境変数に登録  

---

## 📝 今後のTODO（アイデア）
- エラーログをCloudWatchに集約  
- Notionで週次・月次レポート生成、予算超過アラートをLINE送信  
- メッセージの定型化・自然言語処理対応  
- 仮想貯金や仮想投資機能の追加  

---

## 🙏 Special Thanks
- LINE Messaging API  
- Notion API  
- Zappa  
- ChatGPT  

---

# 🌐 English Version

---

## 📝 Overview
LINE Household Bot automatically records your expenses in Notion via AWS Lambda.  
You can easily track your daily spending directly from LINE.

---

## 🛠 Technologies Used
- Python 3.10  
- Flask  
- LINE Messaging API (line-bot-sdk)  
- Notion API (notion-client)  
- AWS Lambda + API Gateway (Zappa)  
- Git / GitHub  

---

## 🚀 Setup (Local)
1. **Create and activate a virtual environment**
    ```bash
    python -m venv venv
    source venv/Scripts/activate  # For Windows (Git Bash)
    ```

2. **Install dependencies**
    ```bash
    pip install -r requirements.txt
    ```

3. **Create `.env` file**  
   Add the following and make sure `.env` is listed in `.gitignore`:
    ```
    LINE_CHANNEL_ACCESS_TOKEN=YourToken
    LINE_CHANNEL_SECRET=YourSecret
    NOTION_TOKEN=YourNotionToken
    DATABASE_ID=YourNotionDatabaseID
    ```

4. **Run the local server**
    ```bash
    python line-bot-server.py
    ```

5. **Expose locally with Ngrok**
    ```bash
    ngrok http 5000
    ```
    Set the generated URL as your Webhook URL in LINE Developers.

---

## ☁ Deployment (AWS Lambda)
1. Initial deploy:  
    ```bash
    zappa deploy dev
    ```
2. Update:  
    ```bash
    zappa update dev
    ```
3. Update your Webhook URL in LINE Developers to the API Gateway URL generated by Zappa.

---

## 📩 Message Format
